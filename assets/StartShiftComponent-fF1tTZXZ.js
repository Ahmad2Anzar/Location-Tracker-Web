import{r,j as e}from"./index-BRKVqLoG.js";import{F as k,h as R,i as S,j as T,k as F,l as P}from"./index-CBXDEUiC.js";function U(){const[n,d]=r.useState(null),[o,j]=r.useState(null),[l,u]=r.useState(null),a=r.useRef(null),m=r.useRef(null),c=r.useRef(null),h=r.useRef(null),[x,g]=r.useState(!1),[p,f]=r.useState(!1),b=async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});a.current.srcObject=t,a.current.play(),g(!0)}catch(t){console.error("Camera access denied:",t)}},v=()=>{if(!x)return;const t=m.current,s=a.current,i=t.getContext("2d");t.width=s.videoWidth,t.height=s.videoHeight,i.drawImage(s,0,0,t.width,t.height),d(t.toDataURL("image/png")),w()},w=()=>{a.current.srcObject&&a.current.srcObject.getTracks().forEach(t=>t.stop()),g(!1)},C=async()=>{try{const t=await navigator.mediaDevices.getUserMedia({video:!0});c.current.srcObject=t,c.current.play(),f(!0)}catch(t){console.error("Camera access denied:",t)}},N=()=>{if(!p)return;const t=h.current,s=c.current,i=t.getContext("2d");t.width=s.videoWidth,t.height=s.videoHeight,i.drawImage(s,0,0,t.width,t.height),u(t.toDataURL("image/png")),y()},y=()=>{c.current.srcObject&&c.current.srcObject.getTracks().forEach(t=>t.stop()),f(!1)};return e.jsxs("div",{className:"flex flex-col items-center justify-center h-screen bg-green-100 p-4",children:[e.jsxs("div",{className:"bg-green-600 text-white p-6 rounded-lg shadow-lg w-full max-w-md text-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Start Your Shift"}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("h4",{className:"text-lg flex items-center justify-center gap-2",children:[e.jsx(k,{})," Your Photo"]}),e.jsx("div",{className:"w-60 h-40 bg-gray-200 flex items-center justify-center rounded-lg border mt-2",children:n?e.jsx("img",{src:n,alt:"Captured",className:"w-full h-full object-cover rounded-lg"}):e.jsx("video",{ref:a,autoPlay:!0,className:"w-full h-full object-cover rounded-lg"})}),e.jsx("canvas",{ref:m,className:"hidden"}),e.jsx("div",{className:"mt-2",children:n?e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:()=>d(null),children:"Retake"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",onClick:b,children:"Open Camera"}),e.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded",onClick:v,disabled:!x,children:"Capture"})]})})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md text-center mt-6",children:[e.jsx("h4",{className:"text-xl font-semibold",children:"Select Transport Mode"}),e.jsx("div",{className:"mt-4 flex flex-wrap justify-center gap-4",children:[{mode:"bike",icon:e.jsx(R,{})},{mode:"car",icon:e.jsx(S,{})},{mode:"train",icon:e.jsx(T,{})},{mode:"bus",icon:e.jsx(F,{})},{mode:"rikshaw",icon:e.jsx(P,{})}].map(({mode:t,icon:s})=>e.jsxs("button",{className:`px-4 py-2 rounded border flex items-center gap-2 ${o===t?"bg-blue-500 text-white":"bg-gray-200"}`,onClick:()=>j(t),children:[s," ",t]},t))})]}),o&&e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md text-center mt-6",children:[e.jsxs("h4",{className:"text-lg font-semibold",children:["Capture ",o," Photo"]}),e.jsx("div",{className:"w-40 h-40 bg-gray-200 flex items-center justify-center rounded-lg border mt-2",children:l?e.jsx("img",{src:l,alt:"Captured",className:"w-full h-full object-cover rounded-lg"}):e.jsx("video",{ref:c,autoPlay:!0,className:"w-full h-full object-cover rounded-lg"})}),e.jsx("canvas",{ref:h,className:"hidden"}),e.jsx("div",{className:"mt-2",children:l?e.jsx("button",{className:"bg-red-500 text-white px-4 py-2 rounded",onClick:()=>u(null),children:"Retake"}):e.jsxs(e.Fragment,{children:[e.jsx("button",{className:"bg-blue-500 text-white px-4 py-2 rounded mr-2",onClick:C,children:"Open Camera"}),e.jsx("button",{className:"bg-green-500 text-white px-4 py-2 rounded",onClick:N,disabled:!p,children:"Capture"})]})})]})]})}export{U as default};
